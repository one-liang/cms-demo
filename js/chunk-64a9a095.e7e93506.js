(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-64a9a095"],{"291b":function(t,e,i){"use strict";i.r(e);i("a4d3"),i("e01a");var c=i("7a23"),l={class:"text-end"},a={class:"table mt-4"},o=Object(c["i"])("thead",null,[Object(c["i"])("tr",null,[Object(c["i"])("th",{width:"120"},"標題"),Object(c["i"])("th",{width:"120"},"作者"),Object(c["i"])("th",null,"文章內容"),Object(c["i"])("th",{width:"120"},"建立時間"),Object(c["i"])("th",{width:"100"},"是否啟用"),Object(c["i"])("th",{width:"200"},"編輯")])],-1),n={class:"text-truncate"},s={key:0,class:"text-success"},r={class:"btn-group"};function d(t,e,i,d,u,b){var m=Object(c["D"])("Loading"),p=Object(c["D"])("Pagination"),h=Object(c["D"])("ArticleModal"),f=Object(c["D"])("DeleteModal");return Object(c["u"])(),Object(c["e"])(c["a"],null,[Object(c["i"])(m,{active:u.isLoading},null,8,["active"]),Object(c["i"])("div",l,[Object(c["i"])("button",{onClick:e[1]||(e[1]=function(t){return b.openModal(!0)}),class:"btn btn-primary",type:"button"}," 新增文章 ")]),Object(c["i"])("table",a,[o,Object(c["i"])("tbody",null,[(Object(c["u"])(!0),Object(c["e"])(c["a"],null,Object(c["B"])(u.articles,(function(e){return Object(c["u"])(),Object(c["e"])("tr",{key:e.id},[Object(c["i"])("td",null,Object(c["G"])(e.title),1),Object(c["i"])("td",null,Object(c["G"])(e.author),1),Object(c["i"])("td",n,Object(c["G"])(e.description),1),Object(c["i"])("td",null,Object(c["G"])(t.$filters.date(e.create_at)),1),Object(c["i"])("td",null,[(Object(c["u"])(),Object(c["e"])("span",s,"啟用"))]),Object(c["i"])("td",null,[Object(c["i"])("div",r,[Object(c["i"])("button",{onClick:function(t){return b.openModal(!1,e)},class:"btn btn-outline-primary btn-sm"}," 編輯 ",8,["onClick"]),Object(c["i"])("button",{onClick:function(t){return b.openDelModal(e)},class:"btn btn-outline-danger btn-sm"}," 刪除 ",8,["onClick"])])])])})),128))])]),Object(c["i"])(p,{pages:u.pagination,onEmitPages:b.getArticles},null,8,["pages","onEmitPages"]),Object(c["i"])(h,{ref:"articleModal",article:u.tempArticle,onUpdateArticle:b.updateArticle},null,8,["article","onUpdateArticle"]),Object(c["i"])(f,{ref:"delModal",item:u.tempArticle,onDelItem:b.delArticle},null,8,["item","onDelItem"])],64)}var u=i("5530"),b=(i("99af"),i("a15b"),i("1799")),m=(i("a434"),{ref:"modal",class:"modal fade",tabindex:"-1"}),p={class:"modal-dialog modal-xl",role:"document"},h={class:"modal-content border-0"},f=Object(c["i"])("div",{class:"modal-header bg-dark text-white"},[Object(c["i"])("h5",{class:"modal-title",id:"exampleModalLabel"},[Object(c["i"])("span",null,"新增文章")]),Object(c["i"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),j={class:"modal-body"},O={class:"row"},g={class:"col-sm-4"},v={class:"mb-3"},A=Object(c["i"])("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),y={class:"mb-3"},x=Object(c["i"])("label",{for:"customFile",class:"form-label"},[Object(c["h"])("或 上傳圖片 "),Object(c["i"])("i",{class:"fas fa-spinner fa-spin"})],-1),w={key:0,class:"mt-5"},U={key:0},M={class:"col-sm-8"},k={class:"mb-3"},P=Object(c["i"])("label",{for:"title",class:"form-label"},"*標題",-1),D={class:"row gx-2"},C={class:"mb-3 col-md-6"},$=Object(c["i"])("label",{for:"author",class:"form-label"},"*作者",-1),V={class:"mb-3 col-md-6"},F=Object(c["i"])("label",{for:"create_at",class:"form-label"},"*建立時間",-1),K={class:"form-control"},S={class:"row gx-2"},_={class:"mb-3 col-md-6"},L=Object(c["i"])("label",{for:"tag",class:"form-label"},"標籤",-1),G=Object(c["i"])("hr",null,null,-1),E={class:"mb-3"},J=Object(c["i"])("label",{for:"description",class:"form-label"},"文章描述",-1),N={class:"mb-3"},B=Object(c["i"])("label",{for:"content",class:"form-label"},"*說明內容",-1),I={class:"mb-3"},T={class:"form-check"},q=Object(c["i"])("label",{class:"form-check-label",for:"isPublic"}," 是否公開 ",-1),z={class:"modal-footer"},H=Object(c["i"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Q(t,e,i,l,a,o){var n=this;return Object(c["u"])(),Object(c["e"])("div",m,[Object(c["i"])("div",p,[Object(c["i"])("div",h,[f,Object(c["i"])("div",j,[Object(c["i"])("div",O,[Object(c["i"])("div",g,[Object(c["i"])("div",v,[A,Object(c["P"])(Object(c["i"])("input",{type:"text",class:"form-control",id:"image",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[1]||(e[1]=function(t){return a.tempArticle.image=t})},null,512),[[c["K"],a.tempArticle.image]])]),Object(c["i"])("div",y,[x,Object(c["i"])("input",{ref:"imgUpload",onChange:e[2]||(e[2]=function(){return o.uploadFile&&o.uploadFile.apply(o,arguments)}),type:"file",id:"customFile",class:"form-control"},null,544)]),Object(c["i"])("img",{class:"img-fluid mb-2",src:a.tempArticle.image},null,8,["src"]),a.tempArticle.imagesUrl?(Object(c["u"])(),Object(c["e"])("div",w,[(Object(c["u"])(!0),Object(c["e"])(c["a"],null,Object(c["B"])(a.tempArticle.imagesUrl,(function(t,e){return Object(c["u"])(),Object(c["e"])("div",{class:"mb-3 input-group",key:e},[Object(c["P"])(Object(c["i"])("input",{type:"url",class:"form-control form-control","onUpdate:modelValue":function(t){return a.tempArticle.imagesUrl[e]=t},placeholder:"請輸入連結"},null,8,["onUpdate:modelValue"]),[[c["K"],a.tempArticle.imagesUrl[e]]]),Object(c["i"])("button",{type:"button",class:"btn btn-outline-danger",onClick:function(t){return a.tempArticle.imagesUrl.splice(e,1)}}," 移除 ",8,["onClick"])])})),128)),a.tempArticle.imagesUrl[a.tempArticle.imagesUrl.length-1]||!a.tempArticle.imagesUrl.length?(Object(c["u"])(),Object(c["e"])("div",U,[Object(c["i"])("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[3]||(e[3]=function(t){return a.tempArticle.imagesUrl.push("")})}," 新增圖片 ")])):Object(c["f"])("",!0)])):Object(c["f"])("",!0)]),Object(c["i"])("div",M,[Object(c["i"])("div",k,[P,Object(c["P"])(Object(c["i"])("input",{"onUpdate:modelValue":e[4]||(e[4]=function(t){return a.tempArticle.title=t}),type:"text",class:"form-control",id:"title",placeholder:"請輸入標題"},null,512),[[c["K"],a.tempArticle.title]])]),Object(c["i"])("div",D,[Object(c["i"])("div",C,[$,Object(c["P"])(Object(c["i"])("input",{"onUpdate:modelValue":e[5]||(e[5]=function(t){return a.tempArticle.author=t}),type:"text",class:"form-control",id:"author",placeholder:"請輸入作者"},null,512),[[c["K"],a.tempArticle.author]])]),Object(c["i"])("div",V,[F,Object(c["i"])("div",K,Object(c["G"])(t.$filters.date(a.tempArticle.create_at)),1)])]),Object(c["i"])("div",S,[Object(c["i"])("div",_,[L,Object(c["P"])(Object(c["i"])("input",{"onUpdate:modelValue":e[6]||(e[6]=function(t){return a.tempArticle.tag=t}),type:"text",class:"form-control",id:"tag",placeholder:"請輸入標籤"},null,512),[[c["K"],a.tempArticle.tag]])])]),G,Object(c["i"])("div",E,[J,Object(c["P"])(Object(c["i"])("textarea",{"onUpdate:modelValue":e[7]||(e[7]=function(t){return a.tempArticle.description=t}),type:"text",class:"form-control",id:"description",placeholder:"請輸入文章描述"},null,512),[[c["K"],a.tempArticle.description]])]),Object(c["i"])("div",N,[B,Object(c["P"])(Object(c["i"])("textarea",{"onUpdate:modelValue":e[8]||(e[8]=function(t){return a.tempArticle.content=t}),type:"text",class:"form-control",id:"content",placeholder:"請輸入產品說明內容"},null,512),[[c["K"],a.tempArticle.content]])]),Object(c["i"])("div",I,[Object(c["i"])("div",T,[Object(c["P"])(Object(c["i"])("input",{"onUpdate:modelValue":e[9]||(e[9]=function(t){return n.tempArticle.isPublic=t}),class:"form-check-input",type:"checkbox","true-value":!0,"false-value":!1,id:"isPublic"},null,512),[[c["J"],this.tempArticle.isPublic]]),q])])])])]),Object(c["i"])("div",z,[H,Object(c["i"])("button",{onClick:e[10]||(e[10]=function(e){return t.$emit("update-article",a.tempArticle)}),type:"button",class:"btn btn-primary"}," 確認 ")])])])],512)}var R=i("e0ae"),W={name:"ArticleModal",mixins:[R["a"]],props:{article:{type:Object,default:function(){}}},watch:{article:function(){console.log("article: ",this.article),this.tempArticle=this.article,this.tempArticle.isPublic||(this.tempArticle.isPublic=!1),void 0===this.tempArticle.create_at&&(this.tempArticle.create_at=(new Date).getTime()/1e3,console.log("create_at: ",this.tempArticle.create_at)),console.log("watch article imagesUrl: ",this.tempArticle.imagesUrl),this.tempArticle.imagesUrl||(this.tempArticle.imagesUrl=[])}},data:function(){return{modal:{},tempArticle:{}}},methods:{uploadFile:function(){var t=this,e=this.$refs.imgUpload.files[0];console.dir("this.$refs.imgUpload.files: ",e);var i=new FormData;i.append("file-to-upload",e);var c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("liang-api","/admin/upload");this.axios.post(c,i).then((function(e){console.log("uploadFile: ",e.data),e.data.success&&(t.tempArticle.image=e.data.image)})).catch((function(t){return console.log(t)}))}}};W.render=Q;var X=W,Y=i("ec05"),Z={name:"Articles",components:{Pagination:b["a"],ArticleModal:X,DeleteModal:Y["a"]},inject:["emitter"],data:function(){return{isLoading:!1,isNew:!1,articles:{},tempArticle:{},pagination:{},currentPage:1}},created:function(){this.getArticles()},methods:{getArticles:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.currentPage=e;var i="".concat("https://vue3-course-api.hexschool.io","/api/").concat("liang-api","/admin/articles?page=").concat(e);this.isLoading=!0,this.axios(i).then((function(e){e.data.success&&(console.log("getArticles: ",e.data),t.articles=e.data.articles,t.pagination=e.data.pagination,t.isLoading=!1)})).catch((function(t){return console.log(t)}))},openModal:function(t,e){var i=this;if(t)this.tempArticle={};else{var c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("liang-api","/admin/article/").concat(e.id);this.axios(c).then((function(t){t.data.success&&(console.log("get a article: ",t.data),i.tempArticle=t.data.article)})).catch((function(t){return console.log(t)}))}this.isNew=t,this.$refs.articleModal.showModal()},updateArticle:function(t){var e=this;this.tempArticle=t;var i="".concat("https://vue3-course-api.hexschool.io","/api/").concat("liang-api","/admin/article"),c="post";this.isNew||(i="".concat("https://vue3-course-api.hexschool.io","/api/").concat("liang-api","/admin/article/").concat(t.id),c="put"),this.axios[c](i,{data:this.tempArticle}).then((function(t){e.$refs.articleModal.hideModal(),t.data.success?(e.getArticles(),e.emitter.emit("push-message",{style:"success",title:"更新成功"})):e.emitter.emit("push-message",{style:"danger",title:"更新失敗",content:t.data.message.join("、")})})).catch((function(t){return console.log(t)}))},openDelModal:function(t){this.tempArticle=Object(u["a"])({},t),this.$refs.delModal.showModal()},delArticle:function(){var t=this,e="".concat("https://vue3-course-api.hexschool.io","/api/").concat("liang-api","/admin/article/").concat(this.tempArticle.id);this.axios.delete(e).then((function(e){t.$refs.delModal.hideModal(),e.data.success?(t.getArticles(),t.emitter.emit("push-message",{style:"success",title:"更新成功"})):t.emitter.emit("push-message",{style:"danger",title:"更新失敗",content:e.data.message.join("、")})})).catch((function(t){return console.log(t)}))}}};Z.render=d;e["default"]=Z},a434:function(t,e,i){"use strict";var c=i("23e7"),l=i("23cb"),a=i("a691"),o=i("50c4"),n=i("7b0b"),s=i("65f0"),r=i("8418"),d=i("1dde"),u=d("splice"),b=Math.max,m=Math.min,p=9007199254740991,h="Maximum allowed length exceeded";c({target:"Array",proto:!0,forced:!u},{splice:function(t,e){var i,c,d,u,f,j,O=n(this),g=o(O.length),v=l(t,g),A=arguments.length;if(0===A?i=c=0:1===A?(i=0,c=g-v):(i=A-2,c=m(b(a(e),0),g-v)),g+i-c>p)throw TypeError(h);for(d=s(O,c),u=0;u<c;u++)f=v+u,f in O&&r(d,u,O[f]);if(d.length=c,i<c){for(u=v;u<g-c;u++)f=u+c,j=u+i,f in O?O[j]=O[f]:delete O[j];for(u=g;u>g-c+i;u--)delete O[u-1]}else if(i>c)for(u=g-c;u>v;u--)f=u+c-1,j=u+i-1,f in O?O[j]=O[f]:delete O[j];for(u=0;u<i;u++)O[u+v]=arguments[u+2];return O.length=g-c+i,d}})},e01a:function(t,e,i){"use strict";var c=i("23e7"),l=i("83ab"),a=i("da84"),o=i("5135"),n=i("861d"),s=i("9bf2").f,r=i("e893"),d=a.Symbol;if(l&&"function"==typeof d&&(!("description"in d.prototype)||void 0!==d().description)){var u={},b=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof b?new d(t):void 0===t?d():d(t);return""===t&&(u[e]=!0),e};r(b,d);var m=b.prototype=d.prototype;m.constructor=b;var p=m.toString,h="Symbol(test)"==String(d("test")),f=/^Symbol\((.*)\)[^)]+$/;s(m,"description",{configurable:!0,get:function(){var t=n(this)?this.valueOf():this,e=p.call(t);if(o(u,t))return"";var i=h?e.slice(7,-1):e.replace(f,"$1");return""===i?void 0:i}}),c({global:!0,forced:!0},{Symbol:b})}}}]);
//# sourceMappingURL=chunk-64a9a095.e7e93506.js.map