(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-94cf4726"],{a434:function(t,e,c){"use strict";var o=c("23e7"),i=c("23cb"),l=c("a691"),a=c("50c4"),n=c("7b0b"),r=c("65f0"),s=c("8418"),d=c("1dde"),u=d("splice"),p=Math.max,b=Math.min,m=9007199254740991,j="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!u},{splice:function(t,e){var c,o,d,u,f,O,h=n(this),g=a(h.length),P=i(t,g),v=arguments.length;if(0===v?c=o=0:1===v?(c=0,o=g-P):(c=v-2,o=b(p(l(e),0),g-P)),g+c-o>m)throw TypeError(j);for(d=r(h,o),u=0;u<o;u++)f=P+u,f in h&&s(d,u,h[f]);if(d.length=o,c<o){for(u=P;u<g-o;u++)f=u+o,O=u+c,f in h?h[O]=h[f]:delete h[O];for(u=g;u>g-o+c;u--)delete h[u-1]}else if(c>o)for(u=g-o;u>P;u--)f=u+o-1,O=u+c-1,f in h?h[O]=h[f]:delete h[O];for(u=0;u<c;u++)h[u+P]=arguments[u+2];return h.length=g-o+c,d}})},e01a:function(t,e,c){"use strict";var o=c("23e7"),i=c("83ab"),l=c("da84"),a=c("5135"),n=c("861d"),r=c("9bf2").f,s=c("e893"),d=l.Symbol;if(i&&"function"==typeof d&&(!("description"in d.prototype)||void 0!==d().description)){var u={},p=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof p?new d(t):void 0===t?d():d(t);return""===t&&(u[e]=!0),e};s(p,d);var b=p.prototype=d.prototype;b.constructor=p;var m=b.toString,j="Symbol(test)"==String(d("test")),f=/^Symbol\((.*)\)[^)]+$/;r(b,"description",{configurable:!0,get:function(){var t=n(this)?this.valueOf():this,e=m.call(t);if(a(u,t))return"";var c=j?e.slice(7,-1):e.replace(f,"$1");return""===c?void 0:c}}),o({global:!0,forced:!0},{Symbol:p})}},e6dc:function(t,e,c){"use strict";c.r(e);var o=c("7a23"),i={class:"text-end"},l={class:"table mt-4"},a=Object(o["i"])("thead",null,[Object(o["i"])("tr",null,[Object(o["i"])("th",{width:"120"},"分類"),Object(o["i"])("th",null,"產品名稱"),Object(o["i"])("th",{width:"120"},"原價"),Object(o["i"])("th",{width:"120"},"售價"),Object(o["i"])("th",{width:"100"},"是否啟用"),Object(o["i"])("th",{width:"200"},"編輯")])],-1),n={class:"text-right"},r={class:"text-right"},s={key:0,class:"text-success"},d={key:1,class:"text-muted"},u={class:"btn-group"};function p(t,e,c,p,b,m){var j=Object(o["D"])("Loading"),f=Object(o["D"])("Pagination"),O=Object(o["D"])("ProductModal"),h=Object(o["D"])("DeleteModal");return Object(o["u"])(),Object(o["e"])(o["a"],null,[Object(o["i"])(j,{active:b.isLoading},null,8,["active"]),Object(o["i"])("div",i,[Object(o["i"])("button",{onClick:e[1]||(e[1]=function(t){return m.openModal(!0)}),class:"btn btn-primary",type:"button"}," 新增產品 ")]),Object(o["i"])("table",l,[a,Object(o["i"])("tbody",null,[(Object(o["u"])(!0),Object(o["e"])(o["a"],null,Object(o["B"])(b.products,(function(e){return Object(o["u"])(),Object(o["e"])("tr",{key:e.id},[Object(o["i"])("td",null,Object(o["G"])(e.category),1),Object(o["i"])("td",null,Object(o["G"])(e.title),1),Object(o["i"])("td",n,Object(o["G"])(t.$filters.currency(e.origin_price)),1),Object(o["i"])("td",r,Object(o["G"])(t.$filters.currency(e.price)),1),Object(o["i"])("td",null,[e.is_enabled?(Object(o["u"])(),Object(o["e"])("span",s,"啟用")):(Object(o["u"])(),Object(o["e"])("span",d,"未啟用"))]),Object(o["i"])("td",null,[Object(o["i"])("div",u,[Object(o["i"])("button",{onClick:function(t){return m.openModal(!1,e)},class:"btn btn-outline-primary btn-sm"}," 編輯 ",8,["onClick"]),Object(o["i"])("button",{onClick:function(t){return m.openDelModal(e)},class:"btn btn-outline-danger btn-sm"}," 刪除 ",8,["onClick"])])])])})),128))])]),Object(o["i"])(f,{pages:b.pagination,onEmitPages:m.getProducts},null,8,["pages","onEmitPages"]),Object(o["i"])(O,{ref:"productModal",product:b.tempProduct,onUpdateProduct:m.updateProduct},null,8,["product","onUpdateProduct"]),Object(o["i"])(h,{ref:"delModal",item:b.tempProduct,onDelItem:m.delProduct},null,8,["item","onDelItem"])],64)}var b=c("5530"),m=(c("99af"),c("a15b"),c("1799")),j=(c("a434"),c("a4d3"),c("e01a"),{ref:"modal",class:"modal fade",tabindex:"-1"}),f={class:"modal-dialog modal-xl",role:"document"},O={class:"modal-content border-0"},h=Object(o["i"])("div",{class:"modal-header bg-dark text-white"},[Object(o["i"])("h5",{class:"modal-title",id:"exampleModalLabel"},[Object(o["i"])("span",null,"新增產品")]),Object(o["i"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),g={class:"modal-body"},P={class:"row"},v={class:"col-sm-4"},y={class:"mb-3"},x=Object(o["i"])("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),U={class:"mb-3"},w=Object(o["i"])("label",{for:"customFile",class:"form-label"},[Object(o["h"])("或 上傳圖片 "),Object(o["i"])("i",{class:"fas fa-spinner fa-spin"})],-1),M={key:0,class:"mt-5"},k={key:0},C={class:"col-sm-8"},D={class:"mb-3"},V=Object(o["i"])("label",{for:"title",class:"form-label"},"標題",-1),$={class:"row gx-2"},_={class:"mb-3 col-md-6"},K=Object(o["i"])("label",{for:"category",class:"form-label"},"分類",-1),F={class:"mb-3 col-md-6"},S=Object(o["i"])("label",{for:"price",class:"form-label"},"單位",-1),L={class:"row gx-2"},G={class:"mb-3 col-md-6"},E=Object(o["i"])("label",{for:"origin_price",class:"form-label"},"原價",-1),J={class:"mb-3 col-md-6"},N=Object(o["i"])("label",{for:"price",class:"form-label"},"售價",-1),B=Object(o["i"])("hr",null,null,-1),I={class:"mb-3"},A=Object(o["i"])("label",{for:"description",class:"form-label"},"產品描述",-1),T={class:"mb-3"},q=Object(o["i"])("label",{for:"content",class:"form-label"},"說明內容",-1),z={class:"mb-3"},H={class:"form-check"},Q=Object(o["i"])("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),R={class:"modal-footer"},W=Object(o["i"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function X(t,e,c,i,l,a){return Object(o["u"])(),Object(o["e"])("div",j,[Object(o["i"])("div",f,[Object(o["i"])("div",O,[h,Object(o["i"])("div",g,[Object(o["i"])("div",P,[Object(o["i"])("div",v,[Object(o["i"])("div",y,[x,Object(o["P"])(Object(o["i"])("input",{type:"text",class:"form-control",id:"image",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[1]||(e[1]=function(t){return l.tempProduct.imageUrl=t})},null,512),[[o["K"],l.tempProduct.imageUrl]])]),Object(o["i"])("div",U,[w,Object(o["i"])("input",{ref:"imgUpload",onChange:e[2]||(e[2]=function(){return a.uploadFile&&a.uploadFile.apply(a,arguments)}),type:"file",id:"customFile",class:"form-control",accept:"image/jpeg,image/jpg,image/png"},null,544)]),Object(o["i"])("img",{class:"img-fluid mb-2",src:l.tempProduct.imageUrl},null,8,["src"]),l.tempProduct.imagesUrl?(Object(o["u"])(),Object(o["e"])("div",M,[(Object(o["u"])(!0),Object(o["e"])(o["a"],null,Object(o["B"])(l.tempProduct.imagesUrl,(function(t,e){return Object(o["u"])(),Object(o["e"])("div",{class:"mb-3 input-group",key:e},[Object(o["P"])(Object(o["i"])("input",{type:"url",class:"form-control form-control","onUpdate:modelValue":function(t){return l.tempProduct.imagesUrl[e]=t},placeholder:"請輸入連結"},null,8,["onUpdate:modelValue"]),[[o["K"],l.tempProduct.imagesUrl[e]]]),Object(o["i"])("button",{type:"button",class:"btn btn-outline-danger",onClick:function(t){return l.tempProduct.imagesUrl.splice(e,1)}}," 移除 ",8,["onClick"])])})),128)),l.tempProduct.imagesUrl[l.tempProduct.imagesUrl.length-1]||!l.tempProduct.imagesUrl.length?(Object(o["u"])(),Object(o["e"])("div",k,[Object(o["i"])("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[3]||(e[3]=function(t){return l.tempProduct.imagesUrl.push("")})}," 新增圖片 ")])):Object(o["f"])("",!0)])):Object(o["f"])("",!0)]),Object(o["i"])("div",C,[Object(o["i"])("div",D,[V,Object(o["P"])(Object(o["i"])("input",{"onUpdate:modelValue":e[4]||(e[4]=function(t){return l.tempProduct.title=t}),type:"text",class:"form-control",id:"title",placeholder:"請輸入標題"},null,512),[[o["K"],l.tempProduct.title]])]),Object(o["i"])("div",$,[Object(o["i"])("div",_,[K,Object(o["P"])(Object(o["i"])("input",{"onUpdate:modelValue":e[5]||(e[5]=function(t){return l.tempProduct.category=t}),type:"text",class:"form-control",id:"category",placeholder:"請輸入分類"},null,512),[[o["K"],l.tempProduct.category]])]),Object(o["i"])("div",F,[S,Object(o["P"])(Object(o["i"])("input",{"onUpdate:modelValue":e[6]||(e[6]=function(t){return l.tempProduct.unit=t}),type:"text",class:"form-control",id:"unit",placeholder:"請輸入單位"},null,512),[[o["K"],l.tempProduct.unit]])])]),Object(o["i"])("div",L,[Object(o["i"])("div",G,[E,Object(o["P"])(Object(o["i"])("input",{"onUpdate:modelValue":e[7]||(e[7]=function(t){return l.tempProduct.origin_price=t}),type:"number",class:"form-control",id:"origin_price",placeholder:"請輸入原價"},null,512),[[o["K"],l.tempProduct.origin_price,void 0,{number:!0}]])]),Object(o["i"])("div",J,[N,Object(o["P"])(Object(o["i"])("input",{"onUpdate:modelValue":e[8]||(e[8]=function(t){return l.tempProduct.price=t}),type:"number",class:"form-control",id:"price",placeholder:"請輸入售價"},null,512),[[o["K"],l.tempProduct.price,void 0,{number:!0}]])])]),B,Object(o["i"])("div",I,[A,Object(o["P"])(Object(o["i"])("textarea",{"onUpdate:modelValue":e[9]||(e[9]=function(t){return l.tempProduct.description=t}),type:"text",class:"form-control",id:"description",placeholder:"請輸入產品描述"},null,512),[[o["K"],l.tempProduct.description]])]),Object(o["i"])("div",T,[q,Object(o["P"])(Object(o["i"])("textarea",{"onUpdate:modelValue":e[10]||(e[10]=function(t){return l.tempProduct.content=t}),type:"text",class:"form-control",id:"content",placeholder:"請輸入產品說明內容",rows:"8"},null,512),[[o["K"],l.tempProduct.content]])]),Object(o["i"])("div",z,[Object(o["i"])("div",H,[Object(o["P"])(Object(o["i"])("input",{"onUpdate:modelValue":e[11]||(e[11]=function(t){return l.tempProduct.is_enabled=t}),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled"},null,512),[[o["J"],l.tempProduct.is_enabled]]),Q])])])])]),Object(o["i"])("div",R,[W,Object(o["i"])("button",{onClick:e[12]||(e[12]=function(e){return t.$emit("update-product",l.tempProduct)}),type:"button",class:"btn btn-primary"}," 確認 ")])])])],512)}var Y=c("e0ae"),Z={name:"ProductModal",mixins:[Y["a"]],props:{product:{type:Object,default:function(){}}},watch:{product:function(){this.tempProduct=this.product,console.log("watch product: ",this.tempProduct.imagesUrl),this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[])}},data:function(){return{modal:{},tempProduct:{}}},methods:{uploadFile:function(){var t=this,e=this.$refs.imgUpload.files[0];this.$refs.imgUpload.value="";var c=new FormData;c.append("file-to-upload",e);var o="".concat("https://vue3-course-api.hexschool.io","/api/").concat("liang-api","/admin/upload");this.axios.post(o,c).then((function(e){console.log("uploadFile: ",e.data),e.data.success&&(t.tempProduct.imageUrl=e.data.imageUrl)})).catch((function(t){return console.log(t)}))}}};Z.render=X;var tt=Z,et=c("ec05"),ct={name:"Products",components:{Pagination:m["a"],ProductModal:tt,DeleteModal:et["a"]},inject:["emitter"],data:function(){return{products:[],pagination:{},tempProduct:{},isNew:!1,isLoading:!1}},created:function(){this.getProducts()},methods:{getProducts:function(t){var e=this,c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("liang-api","/admin/products?page=").concat(t);this.isLoading=!0,this.axios.get(c).then((function(t){t.data.success&&(console.log("products: ",t.data),e.products=t.data.products,e.pagination=t.data.pagination,e.isLoading=!1)})).catch((function(t){return console.log(t)}))},openModal:function(t,e){console.log("openModal: ",t,e),this.tempProduct=t?{}:Object(b["a"])({},e),this.isNew=t,this.$refs.productModal.showModal()},updateProduct:function(t){var e=this;this.tempProduct=t;var c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("liang-api","/admin/product"),o="post";this.isNew||(c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("liang-api","/admin/product/").concat(t.id),o="put"),this.axios[o](c,{data:this.tempProduct}).then((function(t){console.log("updateProduct: ",t),e.$refs.productModal.hideModal(),t.data.success?(e.getProducts(),e.emitter.emit("push-message",{style:"success",title:"更新成功"})):e.emitter.emit("push-message",{style:"danger",title:"更新失敗",content:t.data.message.join("、")})})).catch((function(t){return console.log(t)}))},openDelModal:function(t){this.tempProduct=Object(b["a"])({},t),this.$refs.delModal.showModal()},delProduct:function(){var t=this,e="".concat("https://vue3-course-api.hexschool.io","/api/").concat("liang-api","/admin/product/").concat(this.tempProduct.id);this.axios.delete(e).then((function(e){t.$refs.delModal.hideModal(),e.data.success?(console.log("delProduct: ",e.data),t.getProducts(),t.emitter.emit("push-message",{style:"success",title:"更新成功"})):t.emitter.emit("push-message",{style:"danger",title:"更新失敗",content:e.data.message.join("、")})})).catch((function(t){return console.log(t)}))}}};ct.render=p;e["default"]=ct}}]);
//# sourceMappingURL=chunk-94cf4726.67fe760c.js.map